###########################################################################

def rk2( t, U, odefun, dt ) :
    q1 = odefun( t, U )
    q1 = odefun( t+dt/2, U+dt/2*q1 )
    return U + dt * q1

###########################################################################

def rk3( t, U, odefun, dt ) :
    q1 = odefun( t,          U            )
    q2 = odefun( t+dt/3.,    U+dt/3.*q1   )
    q2 = odefun( t+2.*dt/3., U+2*dt/3.*q2 )
    return U + dt/4. * ( q1 + 3.*q2 )

###########################################################################

def rk4( t, U, odefun, dt ) :
    q1 = odefun( t,       U          )
    q2 = odefun( t+dt/2., U+dt/2.*q1 )
    q3 = odefun( t+dt/2., U+dt/2.*q2 )
    q4 = odefun( t+dt,    U+dt*q3    )
    return U + dt/6. * ( q1 + 2.*q2 + 2.*q3 + q4 )

###########################################################################